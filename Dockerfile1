FROM amazonlinux:2

RUN yum -y update --skip-broken \
    && yum -y upgrade \
    && yum install -y amazon-linux-extras
    
RUN amazon-linux-extras | grep -i python

RUN python --version

RUN yum -y groupinstall "Development Tools" \
    && yum -y install openssl-devel bzip2-devel libffi-devel wget

RUN wget https://www.python.org/ftp/python/3.9.5/Python-3.9.5.tgz \
    && tar xvf Python-3.9.5.tgz \
    && cd Python-3.9*/ \
    && ./configure --enable-optimizations \
    && make altinstall
    
RUN python3.9 --version

RUN ls -l /usr/bin/python* \
    && update-alternatives --install /usr/bin/python python /usr/bin/python3.9 2 \
    && update-alternatives --display python \
    && update-alternatives --set python /usr/bin/python3.9

RUN python3.9 --version \
    && python --version

RUN python3.9 -m pip --version \
    && python -m pip --version
